create table if not exists ref_calculated_daily_customer_file
(
 account_id bigint distkey,
elec_ssd timestamp,
gas_ssd timestamp,
elec_ed timestamp,
gas_ed timestamp,
acc_ssd timestamp,
acc_ed timestamp,
num_elec_mpns bigint,
num_gas_mpns bigint,
first_canc_elec_ssd timestamp,
first_canc_elec_sed timestamp,
first_canc_gas_ssd timestamp,
first_canc_gas_sed timestamp,
num_canc_elec_mpns bigint,
num_canc_gas_mpns bigint,
eac_industry double precision,
aq_industry double precision,
eac_igloo_ca double precision,
eac_igloo_ca_source varchar(256),
aq_igloo_ca double precision,
aq_igloo_ca_source varchar(256),
reg_pay_amount double precision,
reg_pay_amount_ex_wu double precision,
wu_amount double precision,
wu_this_year boolean,
reg_pay_date double precision,
projected_savings double precision,
balance double precision,
elec_annual_spend double precision,
gas_annual_spend double precision,
elec_reg_status varchar(13),
elec_cancellation_reason varchar(65535),
gas_reg_status varchar(13),
gas_cancellation_reason varchar(65535),
elec_loss_type varchar(3),
gas_loss_type varchar(3),
supply_type varchar(5),
account_status varchar(13),
account_loss_type varchar(3),
gsp varchar(255),
ldz varchar(255),
wl0_date timestamp,
wl1_date timestamp,
home_move_in boolean,
gas_et1 boolean,
elec_et1 boolean,
signup_channel varchar(255),
signup_channel_secondary varchar(255),
broker_name varchar(255),
broker_urn varchar(255),
signup_date timestamp,
campaign varchar(87),
quoted_eac double precision,
quoted_aq double precision,
quoted_total_spend double precision,
first_payment_success boolean,
num_payments bigint,
latest_dd_received_date timestamp,
expected_payment_missing boolean,
outcode varchar(255),
first_bill_date timestamp,
first_bill_type varchar(9),
latest_bill_date timestamp,
latest_bill_type varchar(9),
num_bills bigint,
first_final_bill_date timestamp,
first_final_refund_date timestamp,
etlchange timestamp
)
diststyle key
sortkey(account_id);

alter table ref_calculated_daily_customer_file owner to igloo;
