SELECT epc.lmk_key,
       epc.address1,
       epc.address2,
       epc.address3,
       epc.postcode,
       epc.building_reference_number,
       epc.current_energy_rating,
       epc.potential_energy_rating,
       epc.current_energy_efficiency,
       epc.potential_energy_efficiency,
       epc.property_type,
       epc.built_form,
       epc.inspection_date,
       epc.local_authority,
       epc.constituency,
       epc.county,
       epc.lodgement_date,
       epc.transaction_type,
       epc.environment_impact_current,
       epc.environment_impact_potential,
       epc.energy_consumption_current,
       epc.energy_consumption_potential,
       epc.co2_emissions_current,
       epc.co2_emiss_curr_per_floor_area,
       epc.co2_emissions_potential,
       epc.lighting_cost_current,
       epc.lighting_cost_potential,
       epc.heating_cost_current,
       epc.heating_cost_potential,
       epc.hot_water_cost_current,
       epc.hot_water_cost_potential,
       epc.total_floor_area,
       epc.energy_tariff,
       epc.mains_gas_flag,
       epc.floor_level,
       epc.flat_top_storey,
       epc.flat_storey_count,
       epc.main_heating_controls,
       epc.multi_glaze_proportion,
       epc.glazed_type,
       epc.glazed_area,
       epc.extension_count,
       epc.number_habitable_rooms,
       epc.number_heated_rooms,
       epc.low_energy_lighting,
       epc.number_open_fireplaces,
       epc.hotwater_description,
       epc.hot_water_energy_eff,
       epc.hot_water_env_eff,
       epc.floor_description,
       epc.floor_energy_eff,
       epc.floor_env_eff,
       epc.windows_description,
       epc.windows_energy_eff,
       epc.windows_env_eff,
       epc.walls_description,
       epc.walls_energy_eff,
       epc.walls_env_eff,
       epc.secondheat_description,
       epc.sheating_energy_eff,
       epc.sheating_env_eff,
       epc.roof_description,
       epc.roof_energy_eff,
       epc.roof_env_eff,
       epc.mainheat_description,
       epc.mainheat_energy_eff,
       epc.mainheat_env_eff,
       epc.mainheatcont_description,
       epc.mainheatc_energy_eff,
       epc.mainheatc_env_eff,
       epc.lighting_description,
       epc.lighting_energy_eff,
       epc.lighting_env_eff,
       epc.main_fuel,
       epc.wind_turbine_count,
       epc.heat_loss_corridoor,
       epc.unheated_corridor_length,
       epc.floor_height,
       epc.photo_supply,
       epc.solar_water_heating_flag,
       epc.mechanical_ventilation,
       epc.address,
       epc.local_authority_label,
       epc.constituency_label
FROM ref_epc_certificates_all epc
       inner join ref_cdb_addresses addr
         on epc.postcode = left(addr.postcode, len(addr.postcode) - 3) + ' ' + right(addr.postcode, 3)
